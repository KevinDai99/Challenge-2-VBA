Sub Calculate()For Each ws In Worksheets'Column Names'ws.Range("K1").Value = "TickerName"ws.Range("L1").Value = "YearlyChange"ws.Range("M1").Value = "PercentChange"ws.Range("N1").Value = "TotalVolume"'Declaration of Variable Names''---------------------------'
Dim Ticker_Name As StringDim Volume_Total As DoubleVolume_Total = 0Dim Summary_Table_Row As IntegerSummary_Table_Row = 2Dim Open_Year As DoubleDim Close_Year As DoubleDim YearlyChange As DoubleDim PercentChange As DoubleDim Last_Row As LongLast_Row = ws.Cells(Rows.Count, 1).End(xlUp).Row  For i = 2 To Last_Row    If ws.Cells(i - 1, 1).Value <> ws.Cells(i, 1).Value Then        Open_Year = ws.Cells(i, 3).Value          Volume_Total = Volume_Total + ws.Cells(i, 7).Value
    ElseIf ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then      Ticker_Name = ws.Cells(i, 1).Value      Close_Year = ws.Cells(i, 6).Value      YearlyChange = Close_Year - Open_Year      PercentChange = YearlyChange / Abs(Open_Year)      Volume_Total = Volume_Total + Cells(i, 7).Value      ws.Range("K" & Summary_Table_Row).Value = Ticker_Name      ws.Range("L" & Summary_Table_Row).Value = YearlyChange      ws.Range("M" & Summary_Table_Row).Value = PercentChange      ws.Range("N" & Summary_Table_Row).Value = Volume_Total      Volume_Total = 0      Summary_Table_Row = Summary_Table_Row + 1
      Else        Volume_Total = Volume_Total + ws.Cells(i, 7).Value            End If        Next i       'Finding Max and Min'   '--------------------------------------------------------'
'1.Rows'ws.Range("P2").Value = "Greatest % Increase"ws.Range("P3").Value = "Greatest % Decrease"ws.Range("P4").Value = "Greatest Total Volume"'2. Columns"ws.Range("Q1").Value = "Ticker"ws.Range("R1").Value = "Value"'3. Assignments'Dim LR As LongLR = ws.Cells(Rows.Count, 11).End(xlUp).Row Dim Max_Volume As DoubleDim Max_Growth As DoubleDim Min_Growth As Double'4. FormatingFor m = 2 To LRws.Range("M" & m).NumberFormat = "0.00%"    If ws.Range("L" & m).Value >= 0 Then        ws.Range("L" & m).Interior.ColorIndex = 3        Else        ws.Range("L" & m).Interior.ColorIndex = 4                End If                Next m        ' 5. Min/Max CalculationMax_Volume = 0#Max_Growth = 0#Min_Growth = 0#For j = 2 To LR       If ws.Range("N" & j).Value > Max_Volume Then    Max_Volume = ws.Range("N" & j).Value    ws.Range("Q4").Value = ws.Range("K" & j).Value    ws.Range("R4").Value = Max_Volume    ElseIf ws.Range("M" & j).Value > Max_Growth Then    Max_Growth = ws.Range("M" & j).Value    ws.Range("Q2").Value = ws.Range("K" & j).Value    ws.Range("R2").Value = Max_Growth    ElseIf ws.Range("M" & j).Value < Min_Growth Then    Min_Growth = ws.Range("M" & j).Value    ws.Range("Q3").Value = ws.Range("K" & j).Value    ws.Range("R3").Value = Min_Growth            End If        Next j'6 Formating for Min/Max Table
 ws.Range("R2").NumberFormat = "0.00%" ws.Range("R3").NumberFormat = "0.00%"     Next wsEnd Sub